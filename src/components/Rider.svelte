<script>
  export let rider;
  export let xScale;
  export let yScale;
  export let curentStep;
  import { tweened } from "svelte/motion";
  import { cubicInOut } from "svelte/easing";

  const tX = tweened(undefined, {
    delay: 0,
    duration: 1000,
    easing: cubicInOut,
  });

  const tY = tweened(undefined, {
    duration: 2000,
    easing: cubicInOut,
  });

  $: tX.set(xScale(rider.rank));
  $: tY.set(yScale(rider.time));

  // $: console.log(rider.stage);
</script>

<defs>
  <linearGradient id="uae" x1="50%" x2="50%" y1="0%" y2="100%">
    <stop offset="55%" stop-color="#FFFFFF " />
    <stop offset="60%" stop-color="#D71C1C" />
    <stop offset="65%" stop-color="#FFFFFF" />
  </linearGradient>
  <linearGradient id="sqs" x1="50%" x2="50%" y1="0%" y2="100%">
    <stop offset="40%" stop-color="#0362C8 " />
    <stop offset="45%" stop-color="#FFFFFF" />
    <stop offset="55%" stop-color="#FFFFFF" />
    <stop offset="60%" stop-color="#DA0101" />
    <stop offset="65%" stop-color="#FFFFFF" />
    <stop offset="70%" stop-color="#FFFFFF" />
    <stop offset="75%" stop-color="#0362C8" />
  </linearGradient>
</defs>

<g transform="translate({$tX - 13},{$tY - 90}) scale(0.95)">
  <path
    d="M3.38659 42.4306L7.59194 43.1306L4.83868 59.6716C4.83868 59.6716 1.45144 60.9806 0.633337 58.9716C-0.184763 56.9627 3.38659 42.4306 3.38659 42.4306Z"
    fill="#CF8F7B"
  />
  <path
    d="M5.73399 54.292L1.03735 53.4705C1.86705 48.6132 3.38645 42.4307 3.38645 42.4307L7.59179 43.1306L5.73399 54.292Z"
    fill={rider.short}
  />
  <path
    d="M22.9633 42.4306L18.7579 43.1306L21.5112 59.6716C21.5112 59.6716 24.8984 60.9806 25.7165 58.9716C26.5346 56.9627 22.9633 42.4306 22.9633 42.4306Z"
    fill="#CF8F7B"
  />
  <path
    d="M20.6156 54.292L25.3123 53.4705C24.4826 48.6132 22.9632 42.4307 22.9632 42.4307L18.7578 43.1306L20.6156 54.292Z"
    fill={rider.short}
  />
  <path
    d="M12.417 0.677924C12.417 0.300573 12.7229 0 13.1002 0V0C13.4776 0 13.7835 0.30057 13.7835 0.677922C13.7835 5.04001 13.7835 29.0169 13.7835 30.3388C13.7835 31.7934 12.417 31.7934 12.417 30.3388C12.417 29.0169 12.417 5.04002 12.417 0.677924Z"
    fill="#D6D6D6"
  />
  <path
    d="M14.6546 33.707H15.1101V33.2515V18.6753C15.1101 18.3336 15.0056 18.007 14.8153 17.756C14.6247 17.5046 14.328 17.3088 13.9639 17.3088H12.2371C11.8729 17.3088 11.5763 17.5046 11.3857 17.756C11.1953 18.007 11.0908 18.3336 11.0908 18.6753V33.2515V33.707H11.5463H14.6546ZM11.5463 18.6753C11.5463 18.1722 11.8556 17.7643 12.2371 17.7643H13.9639C14.0116 17.7643 14.0581 17.7707 14.1031 17.7829C14.4179 17.8678 14.6546 18.2351 14.6546 18.6753V32.796V33.2515H14.1991H12.0018H11.5463V32.796V18.6753Z"
    fill="#D6D6D6"
  />
  <rect
    x="0.573975"
    y="84.7234"
    width="25.0527"
    height="0.911007"
    fill="#D6D6D6"
  />
  <path
    d="M0.162831 83.9157C-0.116298 83.3574 1.00023 83.2178 1.27937 83.497C2.25636 84.7531 1.41894 89.9172 2.39593 92.8482C2.25636 93.546 1.69811 94.1043 1.2794 93.6856C-0.395439 91.1733 1.13982 86.1489 0.162831 83.9157Z"
    fill="#D6D6D6"
  />
  <path
    d="M26.0376 83.9157C26.3167 83.3574 25.2002 83.2178 24.9211 83.497C23.9441 84.7531 24.7815 89.9172 23.8045 92.8482C23.9441 93.546 24.5023 94.1043 24.921 93.6856C26.5959 91.1733 25.0606 86.1489 26.0376 83.9157Z"
    fill="#D6D6D6"
  />
  <path
    d="M0.118769 64.6814H5.12931C5.12931 64.6814 4.446 71.514 4.44605 74.0192C4.4461 76.5245 5.58481 81.3073 5.12931 83.1293C4.67381 84.9513 6.95132 85.1791 5.12931 86.7733C3.3073 88.3676 2.62409 87.4566 2.16859 85.8623C1.71308 84.2681 2.68229 84.7364 2.62409 82.6738C2.51852 78.9324 0.469352 73.4951 0.118776 69.9197C-0.142972 67.2502 0.118769 64.6814 0.118769 64.6814Z"
    fill="#CF8F7B"
  />
  <path
    d="M26.3446 64.6814H21.3341C21.3341 64.6814 22.0174 71.514 22.0173 74.0192C22.0173 76.5245 20.8786 81.3073 21.3341 83.1293C21.7896 84.9513 19.5121 85.1791 21.3341 86.7733C23.1561 88.3676 23.8393 87.4566 24.2948 85.8623C24.7503 84.2681 23.7811 84.7364 23.8393 82.6738C23.9449 78.9324 25.994 73.4951 26.3446 69.9197C26.6064 67.2502 26.3446 64.6814 26.3446 64.6814Z"
    fill="#CF8F7B"
  />
  <path
    d="M13.2095 30.1064C10.0185 29.8779 6.9618 31.1884 5.23829 33.7162C2.93022 37.1014 2.98781 39.9668 3.07448 44.2789C3.1161 46.3493 3.16442 48.7533 2.9608 51.7086C2.4931 58.4967 0 64.9182 0 64.9182L5.11892 64.9183C5.75659 60.2683 9.13612 56.7201 13.2095 56.7199V30.1064ZM13.2097 30.1064C16.4006 29.878 19.4573 31.1885 21.1807 33.7163C23.4888 37.1015 23.4312 39.9668 23.3446 44.2789C23.3029 46.3494 23.2546 48.7534 23.4582 51.7086C23.9259 58.4967 26.419 64.9183 26.419 64.9183L21.3008 64.9183C20.6631 60.2682 17.2834 56.7199 13.2099 56.7199H13.2097V30.1064Z"
    fill={rider.rank === 1 ? "#ECB70C" : rider.jersey}
  />
  <path
    d="M21.1811 33.7162C19.4576 31.1885 16.4009 29.8779 13.21 30.1064V39.1921C16.8356 39.2154 20.2721 39.7936 23.3548 40.8115C23.2622 38.2429 22.8128 36.1095 21.1811 33.7162ZM13.2098 39.1921C13.134 39.1916 13.0582 39.1914 12.9824 39.1914C9.45292 39.1914 6.09871 39.7173 3.07056 40.6635C3.17517 38.1606 3.63821 36.0634 5.23852 33.7163C6.96203 31.1885 10.0188 29.8779 13.2098 30.1064V39.1921Z"
    fill={rider.short}
  />
  <path
    d="M12.417 68.7808H13.7835C13.7835 68.7808 13.7835 99.3394 13.7835 100.878C13.7835 102.417 12.417 102.417 12.417 100.878C12.417 99.3394 12.417 68.7808 12.417 68.7808Z"
    fill="#D6D6D6"
  />
  <path
    d="M11.0509 55.5715C12.5266 55.3437 13.2099 55.3437 15.2487 55.5715C17.0804 55.7762 17.829 59.885 18.1329 63.4809C18.3847 66.4606 15.9351 68.865 12.9448 68.865V68.865C10.0917 68.865 7.69982 66.6682 7.82245 63.8178C7.9775 60.2136 8.66944 55.9391 11.0509 55.5715Z"
    fill={rider.helmet}
  />
  <path
    d="M11.6225 84.9268H11.167V85.3823V87.5295C11.167 88.2842 11.7788 88.8961 12.5335 88.8961H13.667C14.4217 88.8961 15.0335 88.2842 15.0335 87.5295V85.3823V84.9268H14.578H11.6225ZM12.5335 88.4405C12.0304 88.4405 11.6225 88.0327 11.6225 87.5295V85.8378V85.3823H12.078H14.1225H14.578V85.8378V87.5295C14.578 88.0327 14.1701 88.4405 13.667 88.4405H12.5335Z"
    fill="#D6D6D6"
  />
</g>
{#if curentStep >= 0 && rider.rank <= 3}
  <text
    dominant-baseline="middle"
    fill="white"
    x="20"
    y="0"
    transform="translate({$tX},{$tY - 90}) rotate(-90)"
    opacity="0.7"
  >
    {rider.name}</text
  >=
{/if}

<style>
  g {
    -webkit-filter: drop-shadow(3px -3px 4px rgba(0, 0, 0, 0.2));
    filter: drop-shadow(3px -3px 4px rgba(0, 0, 0, 0.2));
  }
</style>
